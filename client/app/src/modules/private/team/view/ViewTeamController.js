var ViewTeamController = function(team, regularPicks, playoffPicks, $scope, $log, $modal, $location, seasonModel, userModel, teamService, gameService) {

  $scope.teamData = team.data;

  $scope.regularPicks = regularPicks.data;
  $scope.playoffPicks = playoffPicks.data;

  $scope.message = function(team) {
    return "here is a message for the coach";
  };

  $scope.activate = function(team) {
    teamService.activateTeam(team)
      .then(function(active) {
        team.active = active;
      });
  };

  $scope.deactivate = function(team) {
    teamService.deactivateTeam(team)
      .then(function(active) {
        team.active = active;
      });
  };

  $scope.isCommish = function(team) {
    return team.commish_emails.indexOf(userModel.user.email) > -1;
  };

  $scope.isCoach = function(team) {
    return team.coach_emails.indexOf(userModel.user.email) > -1;
  };

  $scope.editTeam = function(team) {
    alert('popup a modal'); // todo: what is this doing here?
  };

  $scope.showLeague = function(team) {
    $location.path('/season/' + team.league.season_id + '/league/' + team.league.id);
  };

  $scope.editTeam = function(team) {

    var modalInstance = $modal.open({
      templateUrl: 'modules/private/team/edit/team.edit.tpl.html',
      controller: 'EditTeamController',
      resolve: {
        team: function() {
          return team;
        }
      }
    });

    modalInstance.result.then(function (team) {
      teamService.updateTeam(team)
        .then(function() {
          $scope.teamData = team;
        });
    }, function () {
      $log.debug('Edit team modal dismissed...');
    });

  };

  $scope.makePick = function() {

    var modalInstance = $modal.open({
      templateUrl: 'modules/private/pick/make/pick.make.tpl.html',
      controller: 'PickMakeController',
      resolve: {
        regularPicks: function() {
          return $scope.regularPicks;
        },
        playoffPicks: function() {
          return $scope.playoffPicks;
        },
        currentGames: function() {
          return gameService.getCurrentGames();
        }
      }
    });

    modalInstance.result.then(function (squadId) {
    }, function () {
      $log.debug('Make pick modal dismissed...');
    });

  };

  /**
   * Invoked on startup, like a constructor.
   */
  var init = function () {
    $log.debug("view team controller");
  };
  init();

};

ViewTeamController.$inject = ['team', 'regularPicks', 'playoffPicks', '$scope', '$log', '$modal', '$location', 'seasonModel', 'userModel', 'teamService', 'gameService'];
module.exports = ViewTeamController;
