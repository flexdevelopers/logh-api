var PlayController = function($scope, $log, $location, $modal, $state, seasonModel, messageModel, weekService, leagueService) {

  $scope.season = seasonModel.season;

  $scope.myTeams = function(season) {
    $location.path('/season/' + season.id + '/my/teams');
  };

  $scope.myLeagues = function(season) {
    $location.path('/season/' + season.id + '/my/leagues');
  };

  $scope.resetSearch = function() {
    $scope.search = {
      name: ""
    };
  };

  $scope.isState = function(states) {
    return _.indexOf(states, $state.current.name) > -1;
  };

  $scope.createLeague = function(season) {

    var modalInstance = $modal.open({
      templateUrl: 'modules/private/league/new/league.new.tpl.html',
      controller: 'NewLeagueController',
      resolve: {
        weeks: function() {
          return weekService.getAvailableWeeks(season.id);
        }
      }

    });

    modalInstance.result.then(function(league) {
      leagueService.createLeague(league);
    }, function () {
      $log.debug('Create league modal dismissed...');
      messageModel.setMessage({ type: 'warning', content: 'Create league cancelled' }, false);
    });

  };

  $scope.joinLeague = function(season) {
    $location.path('/season/' + season.id + '/leagues/public');
  };

    /**
   * Invoked on startup, like a constructor.
   */
  var init = function () {
    $log.debug("play controller");
  };
  init();

};

PlayController.$inject = ['$scope', '$log', '$location', '$modal', '$state', 'seasonModel', 'messageModel', 'weekService', 'leagueService'];
module.exports = PlayController;
